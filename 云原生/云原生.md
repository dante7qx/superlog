## 云原生

### 一. 云平台

- **IaaS**

  计算、网络、存储等基础资源，这些资源是可编程且不可变的，可通过 API 对外提供服务。

- **PaaS**

  在 **IaaS** 之上，将运维工作解放给平台，对开发和运行时进行全面支持。

- **SaaS**

  将应用的开发、管理、部署都交给第三方，不需要关心技术问题，用户拿来即用。

### 二. 云原生

​	云并非把原先在物理服务器上跑的东西放到虚拟机里跑，真正的云化不仅是基础设施和平台的事情，应用也要做出改变，改变传统的做法，实现云化的应用——应用的架构、应用的开发方式、应用部署和维护技术都要做出改变，真正的发挥云的弹性、动态调度、自动伸缩等一些传统IT所不具备的能力。

​	云原生不是一个产品，而是一套技术体系和一套方法论，而数字化转型是思想先行，从内到外的整体变革。更确切地说，它是一种文化，更是一种潮流，是云计算的一个必然导向。

![CNA](./images/CNA.png)

#### ​1. 持续交付

软件开发人员如何将一个好点子，以最快的速度交付给用户的方法。整个过程包括：持续集成 + 持续交付 + 持续部署，即一整套 ”发布流水线“。

![持续交付](./images/持续交付.png)

**持续集成**：**从编码到构建再到测试的反复持续过程**。“持续集成”一旦完成，则代表产品处在一个可交付状态，但并不代表这是最优状态，还需要根据外部使用者的反馈逐步优化。当然这里的使用者并不一定是真正的用户，还可能是测试人员、产品人员、用户体验工程师、安全工程师、企业领导等等。（构建的自动化）

**持续交付：** **持续集成**后，获取外部对软件的反馈，在通过**持续集成**进行优化的过程。（反馈的自动化）

**持续部署：**将可交付的产品，快速且安全的交付用户使用的一套方法和系统。（部署的自动化）

针对传统企业，分为3类

- 第一类

节奏慢、版本发布频率不高，上线出故障影响面不广、影响度不高。

- 第二类

节奏相对慢、版本发布频率不算高，上线出故障影响面广、影响度高。

- 第三类

节奏快、版本发布频率高，上线出故障影响面广、影响度高。

#### 2. 微服务

应用的内聚更强、更加敏捷，让应用更好、更快的交付给客户。那问题在于：

1. 什么样的应用需要微服务？

2. 微服务需要如何进行切割？

3. 如何自动化部署？ 


#### 3. 容器化

- 统一了应用交付的标准。

- 规定了部署环境的一致性。
- 确保了运行时的隔离性。
- 实现了强大的可移植性。

#### 4. DevOps

![DevOps](./images/DevOps.png)

DevOps是一个敏捷思維，是一个沟通的文化，当运维和研发有良好的沟通效率，才可以有更大的生产力。

1. 组织架构、企业文化与理念等，需要自上而下设计，用于促进开发部门、运维部门和质量保障部门之间的沟通、协作与整合，简单而言组织形式类似于系统分层设计。
2. 自动化是指所有的操作都不需要人工参与，全部依赖系统自动完成。

### 三. 如何支持

#### 1. 说服客户

![架构演化](./images/架构演化.png)



#### 2. 持续交付流水线

- **CI — 持续集成** 

  一个应用服务（Java为例），从编码到交付部署，需要经过一系列的过程。

  

- **CD — 持续部署**

  要依靠云平台的能力，实现自动化的部署。

  

#### 3. 云原生支持

- 阶段一：应用容器化部署

  将应用通过容器的方式进行部署，对应用不做改动或做很少的改动。

- 阶段二：应用拆分

  对应用进行模块化的拆分，基于 SOA 的理念。后端的数据库不做改造。

- 阶段三：微服务化改造

  微服务化的拆分，应用 + 数据库

### 四. CaaS 平台		

具体的支持方案

#### 1. 镜像构建

-  **Dockerfile**

-  **Push**

-  **组合构建**

#### 2. 部署方式

- **平台自动化部署**
- **API 自动化部署**

#### 4.微服务的支持



#### 5. 应用监控



#### 6. 日志方案



### 八. 参考资料

- https://blog.csdn.net/cf2SudS8x8F0v/article/details/82836707
- http://www.ruanyifeng.com/blog/2017/07/iaas-paas-saas.html
- https://www.sohu.com/a/240226763_262549
- http://www.mayiwenku.com/p-2496493.html
- https://mp.weixin.qq.com/s?__biz=MzA5OTAyNzQ2OA==&mid=2649699609&idx=1&sn=6df8980ab90d7198923d76cc7a0d57a1&chksm=88930a7abfe4836c71d7688e7f70d554a50f6dbfb07cdca96e9517883bfe5f096119e3646895&mpshare=1&scene=1&srcid=1202nqe7qqQNRiweMaNMRKpk&key=b7f7523840291edcf88ab9d2697e77b5b5f578168a8d6cd7d60b531baeacf2c79b7a2d04d1b57fabb85eb84aa310a2b83a639a373c131b184318e78abe3c315b347d30829390c01ae2d986f0122786dd&ascene=0&uin=MTY1MzQxMzYxNg%3D%3D&devicetype=iMac+MacBookPro12%2C1+OSX+OSX+10.14.1+build(18B75)&version=12020010&nettype=WIFI&lang=zh_CN&fontScale=100&pass_ticket=IpTWnPIiWmIP5ItbQ2TTfulyjD9IwQot9P0C0ztQ7%2BYCF%2F8IYW8Tl2E03k3CKNkc
- https://mp.weixin.qq.com/s?__biz=MzI1NzYzODk4OQ==&mid=2247484962&idx=1&sn=af630988628021e0016c8764293ed48a&chksm=ea151100dd62981645198dc7624004008c0babf6da195e2c374e3da276604c401946851db3f0&scene=21#wechat_redirect